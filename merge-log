#!/bin/sh

if test -e all-final.log; then
    rm all-final.log
fi
touch all-final.log

cd ..
git rev-list --timestamp LIBREOFFICE_CREATE.. | sed -e "s:\$: ..:" >>$OLDPWD/all.log
cd $OLDPWD

for repo in `ls`; do
    if test -d $repo; then
        cd $repo
        git rev-list --timestamp LIBREOFFICE_CREATE.. | sed -e "s:\$: $repo:" >>../all.log
        cd ..
    fi
done

sort +0 -1 all.log > all.log.new
mv all.log.new all.log

while read entry ; do
    timestamp=`echo $entry | cut -d ' ' -f 1`
    commitid=`echo $entry | cut -d ' ' -f 2`
    repo=`echo $entry | cut -d ' ' -f 3`
    if test "$timestamp" != "0" && test "$commitid" != "f07fbb7f983625881c1adb97768f1d9eaf250b22"; then
        cd $repo
        git show $@ $commitid >>$OLDPWD/all-final.log
        cd $OLDPWD
    fi
done < all.log

cat all-final.log
rm all.log
rm all-final.log
